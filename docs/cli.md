# CLI

picam には CLI アプリケーションも同梱されており、コマンドライン上でカメラに関するいくつかのコマンドを実行できます。以下では、そのコマンドについて説明します。

## インストール

picam コマンドはパッケージインストール時に自動的にインストールされます。パッケージインストールについては[こちら](./index.md)を参照してください。

## コマンド

以下の形式のコマンドを実行して、デジタル IO によって制御できるレコーダーを起動します：

```bash
picam [OPTIONS] PIN
```

プログラムの基本的なフローについては[フローチャート](flowchart.md)を参照してください。

### `PIN`

この引数は監視するデジタル入力ピンを設定します。ピン番号の値は 0 ~ 26 のいずれかである必要があります。Raspberry Pi のピン番号の振り方は2通り存在しますが、ここでは BCM 番号を用います。

```bash
# ピン番号を25にして起動
picam 25
```

### `--fname`, `-f`

このオプションは出力される動画のファイル名を指定するためのものです。ファイル名は拡張子も含む必要があります。デフォルトでは `mov_yyyymmdd-HH:MM:SS.h264` というフォーマットで保存されます。

```bash
# ファイル名を指定して起動
picam -f flight_movie.h264 25
```

### `--interval`, `-i`

このオプションはデジタル入力ピンの電圧レベルを監視する時間間隔を指定します。デフォルトは1秒です。このオプションも "--timeout" オプションで使用できる時間フォーマットを使用できます。

```bash
# ピンを監視する時間間隔を0.5秒に設定して起動
picam -i 0.5 25
```

### `--resolution`, `-r`

このオプションでは動画の解像度を設定できます。指定する際は `width:height` のようにセミコロン `:` で区切って指定します。デフォルトでは `640:480` です。

```bash
# 解像度を 200:200 にして起動
picam -r 200:200 25
```

### `--start-with-low`

このオプションはフラグとして使用され、このフラグを指定すると入力ピンが Low になると撮影が開始し、High にすると撮影が終了します。このフラグを指定しない場合は、入力ピンの電圧レベルによる挙動が逆になり、High になると撮影が開始し、Low になると撮影が終了します。

### `--timeout`, `-t`

このオプションでは撮影のタイムアウトを設定できます。設定したタイムアウトの時間を超過すると、フライトカメラのプログラムは終了します。デフォルトではタイムアウトの設定はありません。

時間を数字のみで指定した場合は、単位は秒として解析されます:

```bash
# タイムアウトを10分に設定して起動
picam -t 600 25
```

時間をより直感的に指定するために 'h', 'm', 's' の文字列を指定することも出来ます:

```bash
# タイムアウトを1時間半に設定して起動
picam -t 1h30m 25
```

整数だけでなく、小数で指定することも可能です:

```bash
# タイムアウトを1時間半に設定して起動 (小数)
picam -t 1.5h 25
```

また、末尾の "s" は省略可能です:

```bash
# タイムアウトを1分20秒に設定して起動
picam -t 1m20 25
```

時間の単位を指定するためのアルファベットには大文字・小文字の区別はありません。
